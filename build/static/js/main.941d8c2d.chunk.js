(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(e,t){e.exports={backendIP:"http://35.176.94.224:8080/",timeLimit:4e3,isTimeLimited:!0,numbers:"1234567890",letters:"abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWQYZ`'-",lettersWithComma:"abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWQYZ`'-,"}},20:function(e,t,a){e.exports=a(55)},26:function(e,t,a){},28:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(18),o=a.n(r),i=(a(26),a(3)),l=a(4),c=a(6),u=a(5),m=a(7),d=(a(28),a(10)),g=a(8),h=a.n(g),v=a(1),p=a.n(v),f=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={user_id:"",fname:"",lname:"",gender:"",sexual_oreintation:"",race:"",profession:"",dob:"1998",status:null,registerStatus:0},a.checkIfCharsAreValid=function(e,t){for(var a=0;a<e.target.value.length;a++)if(!t.includes(e.target.value[a]))return!1;return!0},a.changeInput=function(e,t,n){if(n=String(n),a.checkIfCharsAreValid(e,n)||0==e.target.value.length)e.target.value.length<=t?a.setState(Object(d.a)({},e.target.name,e.target.value)):alert("Length should be "+t+".");else{var s;switch(n){case p.a.numbers:s="numbers";break;case p.a.letters:s="letters, spaces or { ` , ' , - }";break;case p.a.lettersWithComma:s="letters, spaces, commas or { ` , ' , - }"}alert("Put only "+s+" in this field.")}},a.change=function(e){"user_id"===e.target.name?a.changeInput(e,9,p.a.numbers):"dob"===e.target.name?a.changeInput(e,4,p.a.numbers):"fname"===e.target.name||"lname"===e.target.name?a.changeInput(e,30,p.a.letters):"race"===e.target.name||"profession"===e.target.name?a.changeInput(e,30,p.a.lettersWithComma):a.setState(Object(d.a)({},e.target.name,e.target.value))},a.sumbitForm=function(e){console.log("sumbitForm"),console.log(e);var t=p.a.backendIP+"reg";h.a.get(t,{params:e}).then(function(e){var t=e.data;switch(console.log("response.data:"+e.data),t){case 0:a.setState({status:"Welcome "+a.state.fname+"! \nNow you can login with your ID: "+a.state.user_id,registerStatus:2});break;case-1:a.setState({status:"User named "+a.state.fname+" is already registerd"}),alert(a.state.status+", choose one from the header and this popup..");break;case-2:a.setState({status:"One or more of the parameters are missing"}),alert(a.state.status+", choose one from the header and this popup..");break;default:a.setState({status:"Unkown error occured"}),alert(a.state.status+", choose one from the header and this popup..")}}).catch(function(e){console.log("Failed :()"),console.log(e.data),a.setState({status:"Error occured, Are one of the parameters are missing or incorrect?"})})},a.onSubmit=function(e){e.preventDefault();var t=a.state;a.sumbitForm(t)},a.showRegister=function(e){a.setState({registerStatus:1}),console.log("register clicked!")},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",null,0===this.state.registerStatus&&s.a.createElement("button",{className:"button",onClick:function(t){return e.showRegister(t)}},"Register"),s.a.createElement("div",{className:"registerForm"},s.a.createElement("h2",{class:"ERROR"},this.state.status),1===this.state.registerStatus&&s.a.createElement("div",{className:"regContainer"},s.a.createElement("h4",null,"Please make sure to fill up all your details correctly"),s.a.createElement("form",null,s.a.createElement("div",{class:"divTable"},s.a.createElement("div",{class:"divTableBody"},s.a.createElement("div",{class:"divTableRow"},s.a.createElement("div",{className:"divTableCell"},"Your ID"),s.a.createElement("div",{class:"divTableCell"},s.a.createElement("input",{type:"number",name:"user_id",min:"010000000",max:"999999999",placeholder:"ID",value:this.state.user_id,onChange:function(t){return e.change(t)}}))),s.a.createElement("div",{class:"divTableRow"},s.a.createElement("div",{class:"divTableCell"},"First Name"),s.a.createElement("div",{class:"divTableCell"},s.a.createElement("input",{name:"fname",type:"text",placeholder:"First Name",value:this.state.fname,onChange:function(t){return e.change(t)}}))),s.a.createElement("div",{class:"divTableRow"},s.a.createElement("div",{class:"divTableCell"},"Last Name"),s.a.createElement("div",{class:"divTableCell"},s.a.createElement("input",{name:"lname",type:"text",placeholder:"Last Name",value:this.state.lname,onChange:function(t){return e.change(t)}}))),s.a.createElement("div",{class:"divTableRow"},s.a.createElement("div",{class:"divTableCell"},"Year of Birth"),s.a.createElement("div",{class:"divTableCell"},s.a.createElement("input",{name:"dob",type:"number",min:"1900",max:"2010",step:"1",value:this.state.dob,onChange:function(t){return e.change(t)}}))),s.a.createElement("div",{class:"divTableRow"},s.a.createElement("div",{class:"divTableCell"},"Gender?"),s.a.createElement("div",{class:"divTableCell"},s.a.createElement("div",{className:"radio-group"},s.a.createElement("input",{id:"option-one",type:"radio",value:"Male",name:"gender",onChange:function(t){return e.change(t)}}),s.a.createElement("label",{for:"option-one"},"Man"),s.a.createElement("input",{id:"option-two",type:"radio",value:"Female",name:"gender",onChange:function(t){return e.change(t)}}),s.a.createElement("label",{for:"option-two"},"Woman")))),s.a.createElement("div",{class:"divTableRow"},s.a.createElement("div",{class:"divTableCell"},"Like Women / Men?"),s.a.createElement("div",{class:"divTableCell"},s.a.createElement("div",{className:"radio-group"},s.a.createElement("input",{id:"option-one1",type:"radio",value:"Women",name:"sexual_oreintation",onChange:function(t){return e.change(t)}}),s.a.createElement("label",{for:"option-one1"},"Woman"),s.a.createElement("input",{id:"option-two2",type:"radio",value:"Men",name:"sexual_oreintation",onChange:function(t){return e.change(t)}}),s.a.createElement("label",{for:"option-two2"},"Man"),s.a.createElement("input",{id:"option-three",type:"radio",value:"Both",name:"sexual_oreintation",onChange:function(t){return e.change(t)}}),s.a.createElement("label",{for:"option-three"},"Both!")))),s.a.createElement("div",{class:"divTableRow"},s.a.createElement("div",{class:"divTableCell"},"Parents from?"),s.a.createElement("div",{class:"divTableCell"},s.a.createElement("input",{name:"race",type:"text",placeholder:"Poland, Iraq, Morroco, etc..",value:this.state.race,onChange:function(t){return e.change(t)}}))),s.a.createElement("div",{class:"divTableRow"},s.a.createElement("div",{class:"divTableCell"},"What do you do?"),s.a.createElement("div",{class:"divTableCell"},s.a.createElement("input",{name:"profession",type:"text",placeholder:"Student/Lecturer/etc..",value:this.state.profession,onChange:function(t){return e.change(t)}}))))),s.a.createElement("div",{class:"divTableRowCentered"},s.a.createElement("button",{class:"registerButton",onClick:function(t){return e.onSubmit(t)}},"Click to Register"))))))}}]),t}(s.a.Component),S=a(19),b=a.n(S),E=function(e){var t="width "+p.a.timeLimit+"ms ease-in",a="smooth"==e.transition?t:"";return s.a.createElement("div",{className:"filler",style:{width:e.percentage+"%",background:e.color,transition:a}})},I=function(e){return s.a.createElement("div",{className:"progress-bar"},s.a.createElement(E,{percentage:e.percentage,color:e.color,transition:e.transition}))},w=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={user_id:null,currImageSrc:"",currLocInSession:0,timeBefore:0,rating:-1,timesUncertain:-1,sessionStatus:null,isFinished:!1,isLoggedIn:!1,sessionType:null,showHello:!1,progressBarPercent:0,sessionColor:null,progressBarTransition:"hard"},a.tasks=["ATTRACTIVENESS","WILLING_FOR_LOAN"],a.localSessionData=null,a.lastImageIndexSession=-1,a.hasUserClicked=!1,a.preloadImages=function(e){console.log("preloadImages "+e.length),a.preloadedImages=[e.length];for(var t=0;t<e.length;t++)a.preloadedImages[t]=new Image,a.preloadedImages[t].src=e[t];console.log("FINISHED LOADING!!!!!!!!!")},a.showWaitingProgressBar=function(){var e=a.state.sessionColor;a.setState({sessionColor:"Black",progressBarPercent:100,progressBarTransition:"smooth"},function(){return setTimeout(function(){a.setState({sessionColor:e,progressBarTransition:"hard",progressBarPercent:0})},p.a.timeLimit-2)})},a.changeRating=function(e,t){a.setState({timesUncertain:a.state.timesUncertain+1,rating:e})},a.setNewImage=function(e){console.log("Showing Image "+e+"/"+a.lastImageIndexSession),a.setState({currLocInSession:e,timeBefore:Date.now(),currImageSrc:a.localSessionData.imagesPath[e],rating:-1,timesUncertain:-1,progressBarPercent:0},function(){a.hasUserClicked=!1})},a.setNewSessionState=function(){a.setState({sessionType:a.localSessionData.sessionType,sessionStatus:""})},a.resetSessionState=function(){a.localSessionData=null,a.lastImageIndexSession=-1,a.setState({currImageSrc:null,sessionType:null,progressBarPercent:0,currLocInSession:-1})},a.hasFinishedSession=function(){return a.state.currLocInSession===a.lastImageIndexSession},a.handleNextSession=function(){if(p.a.isTimeLimited&&(clearInterval(a.progressInterval),console.log("clearInterval(this.progressInterval)")),a.sessionNum+=1,a.sessionNum<2){console.log("FINISHED SESSION");var e=a.state.sessionType===a.tasks[0]?a.tasks[1]:a.tasks[0],t="green"===a.state.sessionColor?"red":"green",n={color:t};a.resetSessionState(),a.setState({sessionStatus:s.a.createElement("div",null,"Nice! you have done great!",s.a.createElement("br",null),"The Next session is:",s.a.createElement("br",null),s.a.createElement("span",{style:n},e))}),a.showWaitingProgressBar(),setTimeout(function(){a.getSessionByType(e),a.setState({sessionType:e,sessionColor:t,progressBarPercent:0})},p.a.timeLimit)}else a.resetSessionState(),a.setState({sessionStatus:"Finished Session. Thank you!",isLoggedIn:!1,isFinished:!0})},a.setNewImageOrGetNextSession=function(){a.hasFinishedSession()?a.handleNextSession():a.setNewImage(a.state.currLocInSession+1)},a.startSessionWithSessionData=function(e){a.localSessionData=e,a.lastImageIndexSession=a.localSessionData.imagesPath.length-1,console.log("SessionType:",a.localSessionData.sessionType," ;#images:",a.localSessionData.imagesPath.length),a.setNewImage(0),a.setNewSessionState();var t=p.a.timeLimit/4;p.a.isTimeLimited&&(a.progressInterval=setInterval(function(){var e=a.state.progressBarPercent;if(null!=a.state.sessionType)if(100===e)a.setNewImageOrGetNextSession();else{var t=e+25;console.log("setInterval triggered, val:",t),a.setState({progressBarPercent:t})}},t))},a.getSessionFromBackend=function(e){var t=p.a.backendIP+"sess";h.a.get(t,{params:e}).then(function(e){var t=e.data;-1===t.sessionId?a.setState({sessionStatus:"User is not registered, re-enter id",user_id:-1}):(console.log("SessionId: ",t.sessionId),a.preloadImages(t.imagesPath),a.state.isLoggedIn?a.startSessionWithSessionData(t):(a.setState({isLoggedIn:!0}),console.log("then: this.state.user_id:",a.state.user_id),a.showWaitingProgressBar(p.a.timeLimit-3),setTimeout(function(){a.startSessionWithSessionData(t),a.setState({showHello:!1})},p.a.timeLimit-2),a.setState({showHello:!0})))}).catch(function(e){console.log("Failed :()"),a.setState({sessionStatus:"could not reach backend 404"})})},a.getSessionByType=function(e){var t={};t.user_id=a.state.user_id,t.type=e,console.log("getSessionByType: user_id=",t.user_id," ; type=",t.type),a.getSessionFromBackend(t)},a.sendRatingToBackend=function(e){var t=p.a.backendIP+"rate";h.a.get(t,{params:e}).then(function(e){console.log("rateResponse: ",e.data," imgNum: ",a.state.currLocInSession),a.setNewImageOrGetNextSession()}).catch(function(e){console.log("Error in sendRatingToBackend"),a.setState({sessionStatus:e.toString()})})},a.createRating=function(e){var t={},n=new Date,s=n.getTime()-60*n.getTimezoneOffset()*1e3;return t.s=a.state.sessionType,t.photoId=a.state.currImageSrc.split("/")[a.state.currImageSrc.split("/").length-1],t.user_id=a.localSessionData.userId,t.ratingValue=a.state.rating,t.ratingUUID=s,t.session=a.localSessionData.sessionId,t.iteration=a.localSessionData.iterationId,t.locationInSession=a.state.currLocInSession,t.timeTook=Date.now()-a.state.timeBefore,t.timesUncertain=a.state.timesUncertain,t.phonePosition=0,console.log("sentRating- photoID:",t.photoId," rating:",a.state.rating),t},a.onSubmitRating=function(e){e.preventDefault(),console.log("onSubmitRating: hasUserClicked:",a.hasUserClicked),null===a.localSessionData||a.hasUserClicked||-1===a.state.rating?console.log("this.state.rating === -1"):(a.hasUserClicked=!0,a.sendRatingToBackend(a.createRating(!0)))},a.startSessions=function(e){console.log("startSessions"+e);var t,n=null;Math.random()>.5?(n=a.tasks[0],t="red"):(n=a.tasks[1],t="green");var s={};s.user_id=e,s.type=n,a.setState({user_id:e,sessionColor:t,isFinished:!1}),a.sessionNum=0,a.getSessionFromBackend(s)},a.restartSessions=function(e){console.log("restartSessions"+a.state.user_id),a.startSessions(a.state.user_id)},a.refreshPage=function(e){window.location.reload()},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"onStarHover",value:function(e,t,a){this.setState({rating:e})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"sessionHolder"},null==this.state.user_id&&this.startSessions(this.props.loggedUserId),s.a.createElement("div",{className:"progressBar"},s.a.createElement(I,{percentage:this.state.progressBarPercent,color:this.state.sessionColor,transition:this.state.progressBarTransition})),s.a.createElement("h3",null,this.state.sessionStatus),-1===this.state.user_id&&s.a.createElement("button",{className:"button",onClick:function(t){return e.refreshPage(t)}},"Try again"),this.state.isFinished&&s.a.createElement("h4",null,"Click on the button below for more!"),this.state.showHello?s.a.createElement("h1",null,"Hello ",this.state.user_id,"!"):!this.state.isFinished&&this.state.sessionType&&s.a.createElement("div",{className:"innerSessionHolder"},s.a.createElement("div",{className:"taskTitle"},this.state.isFinished||"ATTRACTIVENESS"!==this.state.sessionType?s.a.createElement("h2",{style:{color:"green"}},"Would you give a loan?"):s.a.createElement("h2",{style:{color:"red"}},"Attractive?")),s.a.createElement("div",{className:"imgContainer"},this.state.currImageSrc&&s.a.createElement("img",{name:"currImage",src:this.state.currImageSrc,className:"displayedImage"})),s.a.createElement("div",{className:"starSubmitContainer"},s.a.createElement(b.a,{rating:this.state.rating,starRatedColor:"gold",starHoverColor:"gold",changeRating:this.changeRating,onStarHover:this.onStarHover.bind(this),numberOfStars:5,name:"rating"}),s.a.createElement("form",null,s.a.createElement("button",{onClick:function(t){return e.onSubmitRating(t)},className:"ATTRACTIVENESS"===this.state.sessionType?"submitRatingButtonA":"submitRatingButtonL"},"Rate!")))),this.state.isFinished&&s.a.createElement("button",{className:"button",onClick:function(t){return e.restartSessions(t)}},"Rate more!"))}}]),t}(s.a.Component),T=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={user_id:"",isFinished:!1,isLoggedIn:!1,sessionType:null,showLogin:!1},a.change=function(e){("0123456789".includes(e.target.value[e.target.value.length-1])||0==e.target.value.length)&&a.setState({user_id:e.target.value,currRating:e.target.value})},a.onSubmitLogin=function(e){e.preventDefault();a.state.user_id,a.props.setLoggedIn(a.state.user_id)},a.showLogin=function(e){a.setState({showLogin:!0}),console.log("Login clicked!")},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{name:"holder"},this.state.showLogin?s.a.createElement("div",{name:"login"},s.a.createElement("form",null,s.a.createElement("input",{name:"user_id",placeholder:"ID",min:"010000000",max:"999999999",value:this.state.user_id,onChange:function(t){return e.change(t)}}),s.a.createElement("button",{className:"button",onClick:function(t){return e.onSubmitLogin(t)}},"Submit"))):s.a.createElement("button",{className:"button",onClick:function(t){return e.showLogin(t)}},"Login"))}}]),t}(s.a.Component),C=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={fields:{},isLoggedIn:!1,userId:null,hello:!0},a.loggedIn=function(e){a.setState({isLoggedIn:!0,userId:e}),console.log("CLICKED ON SUBMIT from login!"+e)},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){document.title="Perah"}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"App"},s.a.createElement("script",{type:"text/javascript"},document.oncontextmenu=new Function("return false;"),document.onselectstart=new Function("return false;")),s.a.createElement("div",{className:"noselect"},s.a.createElement("div",{className:"disabledrag"},s.a.createElement("div",{className:"app-container"},this.state.isLoggedIn?s.a.createElement("div",null,s.a.createElement(w,{loggedUserId:this.state.userId})):s.a.createElement("div",{className:"TOP_login"},s.a.createElement("h1",null,"Welcome to Perah App!"),s.a.createElement("h2",null,"Login or register to start"),s.a.createElement("div",{className:"loginRegisterContainer"},s.a.createElement(T,{setLoggedIn:function(t){return e.loggedIn(t)}}),s.a.createElement("br",null),s.a.createElement(f,{onregistered:function(t){return e.registered(t)}})))))))}}]),t}(n.Component),y=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function k(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(s.a.createElement(C,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");y?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):k(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):k(e)})}}()}},[[20,2,1]]]);
//# sourceMappingURL=main.941d8c2d.chunk.js.map